\documentclass[oneside, 12pt]{amsart}
\usepackage{amscd, amsmath, amssymb, amsthm, amsfonts, amstext, geometry, verbatim, enumitem, graphicx, mathtools, xfrac, microtype, nameref, thmtools}
\usepackage[breaklinks=true]{hyperref}
\usepackage[capitalize]{cleveref}
\usepackage[hyperref=true, backend=bibtex, firstinits=true, citestyle=numeric-comp, sortlocale=en_US, url=false, doi=false, eprint=true, maxbibnames=4]{biblatex}            
%\usepackage[notref,notcite]{showkeys}
\usepackage[matrix,arrow,curve]{xy}

\addbibresource{question.bib}
\renewbibmacro*{volume+number+eid}{\ifentrytype{article}{\- \iffieldundef{volume}{}{Vol.~\printfield{volume},}\iffieldundef{number}{}{ No.~\printfield{number},}}}
\renewbibmacro{in:}{\ifentrytype{article}{}{\printtext{\bibstring{in}\intitlepunct}}}
\newbibmacro{string+doi}[1]{\iffieldundef{doi}{\iffieldundef{url}{#1}{\href{\thefield{url}}{#1}}}{\href{http://dx.doi.org/\thefield{doi}}{#1}}}
\DeclareFieldFormat[article, inproceedings, inbook, book, thesis]{title}{\usebibmacro{string+doi}{\mkbibquote{#1}}}
\renewcommand*{\bibfont}{\footnotesize}

\newlist{lemlist}{enumerate}{1} \setlist[lemlist]{label={\rm(\arabic{lemlisti})}, ref=\thelemma.(\arabic{lemlisti}),noitemsep} \Crefname{lemlisti}{Lemma}{Lemmas}

\theoremstyle{plain}

\newtheorem{thm}{Theorem}
\Crefname{thm}{Theorem}{Theorems}
\numberwithin{equation}{section}

\newtheorem{lemma}{Lemma}
\numberwithin{lemma}{section}
\Crefname{lemma}{Lemma}{Lemmas}

\newtheorem{cor}[lemma]{Corollary}
\Crefname{cor}{Corollary}{Corollaries}

\newtheorem{prop}[lemma]{Proposition}
\Crefname{prop}{Proposition}{Propositions}

\newtheorem*{thm*}{Theorem}
\newtheorem*{lemma*}{Lemma}

\theoremstyle{remark}

\newtheorem{rem}[lemma]{Remark}
\Crefname{rem}{Remark}{Remarks}

\theoremstyle{definition}

\newtheorem{df}[lemma]{Definition} \Crefname{df}{Definition}{Definitions}
\newtheorem{example}[lemma]{Example} \Crefname{example}{Example}{Examples}

\newcommand{\catname}[1]{{\normalfont\textbf{#1}}}
\DeclareMathOperator{\HH}{H}
\DeclareMathOperator{\colim}{colim}
\DeclareMathOperator{\Ker}{Ker}
\DeclareMathOperator{\hh}{\overline{{\it h}}}
\newcommand{\ZZ}{\mathbb{Z}}
\newcommand{\pushoutcorner}[1][dr]{\save*!/#1+1.2pc/#1:(1,-1)@^{|-}\restore}
\newcommand{\pullbackcorner}[1][dr]{\save*!/#1-1.2pc/#1:(-1,1)@^{|-}\restore}

\title{Parametrized symmetric groups}
\keywords {$\mathfrak{U}(G)$-extensions, $\mathfrak{H}_n(G)$-extensions, amalgamated products, van Kampen theorem}

\author {Sergey Sinchuk}

\date {\today}

\begin{document}

\begin{abstract} By amalgamating copies of symmetric group $S_n$ we construct a central extension $S_n(G)$ of a large subgroup of the wreath product $G \wr S_n$.
%We call this group a parametrized symmetric group by analogy with parametrized braid groups defined by M.~Stein and J.~L.~Loday in ???.
We then establish a connection between this group and the theory of $\mathfrak{U}(G)$ and $\mathfrak{H}_n(G)$-extensions developed by K.~Dennis and U.~Rehmann in 1970's.
We also give a topological application of this construction by describing the fundamental group of the fiber of the ``alternating`` map $BG^{2n}\to \mathbb{Z}[BG]$.
\end{abstract}

\maketitle

\section{Introduction}
Let $G$ be a group. In~\cite{De76} K.~Dennis defined certain central extension $(G, G)$ of the derived subgroup $[G, G]$ 
 (see section~\ref{ssec:extensions} below for the definition).
This extension is a quotient of the nonabelian tensor square $G \otimes G$ (but is itself an extension of $\bigwedge^2G$) such that the kernel of the natural map $(G, G) \to [G, G]$ 
 is Dennis functor $\widetilde{H}_2(G, \mathbb{Z})$.
Under the notation $U(G)$ the same extension appears in U.~Rehmann's paper~\cite{Reh78}, where it is used to formulate the noncommutative version of Matsumoto theorem.
Recall that this theorem asserts for a skew-field $D$ that the group $K_2(D)$ is precisely the quotient of $\widetilde{H}_2(D^*, \mathbb{Z})$ modulo Steinberg relations $\{u, 1-u\} = 1$, $u\in D^*$.

The aim of this note is to describe yet another situation in which the groups $(G, G)$ and $\Lambda^2(G)$ make an appearance.
We start by defining an extension $S_n(G)$ of the symmetric group $S_n$ which we call a {\it parametrized symmetric group} by analogy
 with parametrized braid groups of M.~Stein and J.-L.~Loday (see~\cite{LS05}).

{\bf TODO: Mention new simpler presentation of Rehmann's extensions for $n\geq 4$}
%We then decompose $S_n(G)$ as $H_n(G)\times S_n(G)$, where $H_n(\Lambda^2G)$ is an extension of the $ $.

%For a based topological space $X$ the {\it infinite symmetric product} of $X$ is a free commutative topological monoid defined as the colimit
%$SP(X):=\colim_{n\to\infty}SP^n(X)$ of finite symmetric products $SP^n(X)=X^n/S_n$ (the colimit is taken with respect to obvious inclusions).
%If $X$ happens to be connected then $SP(X)$ becomes homotopy equivalent to the free abelian topological group $AG(X)$ with basis $X$.

Unsurprisingly, the main motivation for the definition of the group $S_n(G)$ comes from algebraic topology.
More specifically, our initial question was to describe the fiber of the ''alternating map`` $X^{2n} \to \mathbb{Z}[X]$ in the special case $X=BG$.

For a pointed simplicial set $(X, x_0)$ one denotes by $\ZZ[X]$ its associated free simplicial abelian group,
 i.\,e. the simplicial group whose group of $n$-simplices $\ZZ[X]_n$ is the quotient of free abelian group $\ZZ[X_n]$ modulo relation $x_0=0$.
There is a unique map of simplicial sets $h_n\colon X^{2n} \to \ZZ(X)$ defined on $0$-simplices by the identity:
 \[h_n(x_1, x_2, \ldots x_{2n}) = \sum\limits_{i=1}^{2n}(-1)^ix_i.\]
Denote by $X^\infty$ the colimit of $X^n$ with respect to the natural embeddings $X^{n} \hookrightarrow X^{n+1}$
Taking colimit of $h_n$ we get the map $h_\infty = \mathrm{colim}_n(h_n) \colon X^\infty \to A(X)$.

Based on a recent result of S.~Podkorytov one can deduce that the natural map $h^{-1}_\infty(0) \to F_{h_\infty}$
 between the fiber and the homotopy fiber of $h_\infty$ over $0$ is a weak equivalence provided $X$ is fibrant and connected, see section~\ref{sec:topo-weak-equiv}.
%%One might be interested in the description of its homotopy fiber $F_{h_\infty}$.
%For example, one can show that the natural map  is a homotopy equivalence, see~\cref{sec:topology}.
For finite $n$ this no longer remains true, however one may expect that the homotopy groups of $h^{-1}_n(0)$ and $F_{h_n}$ are still
 isomorphic in small degrees. % for some sufficiently good $X$, say $X$ fibrant and connected.
We even expect that the natural map $h^{-1}_n(0) \to F_{h_n}$ is $c_n$-connected where $c_n$ tends to infinity as $n\to \infty$,
however in this note we only show the following, much weaker result.
\begin{thm} \label{thm:main} If $X=BG$ is the classifying space of a group $G$ then for $n\geq 3$ the natural map $h_n^{-1}(0) \to F_{h_n}$ induces an isomorphism of fundamental groups
 $\pi_1(h^{-1}_n(0))\cong \pi_1(F_{h_n}) \cong \HH_2(G, \ZZ)$. \end{thm}

\subsection{Acknowledgements}
I wish to thank S.~Podkorytov for suggesting the problem and also for his kind permission 
 to use some of his unpublished results in section~\ref{sec:topo-prelim}.
I am also grateful to S.~O.~Ivanov and V.~Isaev for their numerous helpful comments and interest in this work.

\section{The extension $S_n(G)$} 
\subsection{The definition of $S_n(G)$} \label{sec:QnG-def}
Let $G$ be a group. Recall that the {\it wreath product} is, by definition,
 the semidirect product $G^n \rtimes S_n$, in which $S_n$ acts on $G^n$ on the right by permuting its factors.

Consider the family $\{{S_n}^{(g)}\}_{g\in G^n}$ of isomorphic copies of $S_n$ indexed by elements of $G^n$ and let $F$ be the free product of groups from this family.
For $s\in S_n$ and $g\in G^n$ we denote by 
$s_{g}$ the image of $s$ in $F$ under the canonical map $S_n^{(g)} \to F$.

\begin{df} We define the group $S_n(G)$ to be the quotient of $F$ modulo the following single family of relations:
\begin{equation} \label{eq:main_rel} s_g = s_h, \text{ where $s$ fixes $h g^{-1}$.} \end{equation} \end{df}

We continue to denote by $s_g$ the image of the element $s_g\in F$ under the canonical map $F\to S_n(G)$.

\begin{rem}
Expanding the definition of the semidirect product we get that
\begin{equation} \nonumber s^g = (1_{G^n}, s)^{(g, 1)} = (g^{-1}, s) (g, 1) = (g^{-1} g^{(s^{-1})}, s). \end{equation}
therefore the equality $s^g = s^h$ holds in $G \wr S_n$ iff
$g^{-1} g^{(s^{-1})} = h^{-1} h^{(s^{-1})}$, or what is the same, iff $s$ fixes $hg^{-1}$.

The last statement immediately implies that the map $\mu \colon S_n(G) \to G \wr S_n$ given by $\mu(s_g) = s^g = (g^{-1}g^{(s^{-1})}, s)$
is well-defined. We will see shortly that $\mu$ is, in fact, a {\it crossed module} in the sense of~\cite[\S~2.2]{BHS11}.
\end{rem}

Observe from the definition of $S_n(G)$ that there is a split exact sequence.
\begin{equation} \label{eq:ex-seq} \xymatrix{1 \ar[r] & \mathrm{Ker}(\pi) \ar[r] &  S_n(G) \ar@<0.5ex>[r]^{\pi} & S_n \ar[r] \ar@{-->}@<0.5ex>[l]^{\iota(1)} & 1,} \end{equation}
Here the map $\pi = \pi_{S_n} \circ \mu$ removes subscript $g$ from each $s_g$ and the section $\iota(1)$ sends $s$ to $s_1$, where $1$ is the identity element of $G^n$.
Thus, if we denote $\mathrm{Ker}(\pi)$ by $HS_n(G)$ we get a decomposition $S_n(G) = HS_n(G) \rtimes S_n$.

\subsection{A crossed module structure on $S_n(G)$}
Recall from~\cite[\S~2.2]{BHS11} that a {\it crossed module} is a morphism of groups $\mu\colon M\to N$ together with a right action of $N$ on $M$ 
compatible with the conjugation action of $N$ on itself, i.\,e.
\begin{equation} \label{eq:precrossed} \tag{CM1} \mu(m^n) = \mu(m)^n \text{ for all $n \in N$, $m \in M$}, \end{equation}
which also satisfies the following identity called {\it Peiffer identity}:
\begin{equation} \label{eq:Peiffer} \tag{CM2} m^{m'} = m^{\mu(m')} \text{ for all $m, m' \in M$}.\end{equation}
In our situation, we let $G \wr S_n$ act on $S_n(G)$ by 
\begin{equation} \label{eq:action} (s_g)^{(h, t)} = {s^t}_{(gh)^t}, \text{ for $s, t \in S_n$ and $g, h \in G^n$.} \end{equation}
The goal of this subsection is to prove the following.
\begin{prop} \label{thm:cms} For $n \geq 3$ the map $\mu \colon S_n(G) \to G \wr S_n $ is a crossed module. \end{prop}
From the fact that $\mu$ is a crossed module one can deduce that $\Ker(\mu)$ is a central subgroup of $S_n(G)$ and $\mathrm{Im}(\mu)$ is a normal subgroup of $G \wr S_n$.
It is not hard to show that the group $S_2(G)$ is isomorphic to a free product of copies of $S_2$ (whose center is always trivial).
Therefore, the requirement $n\geq 3$ in the statement of~\cref{thm:cms} is essential.

%To give $\mu$ the structure of a precrossed module we must first specify an action of $G \wr S_n$ on $Q_n(G)$.
%We accomplish this by means of the following relation:

%Clearly the above formula defines an action of $G \wr S_n$ on $\widetilde{Q}$. We must check that relations~\eqref{eq:main_rel} are preserved by this action.
%Indeed, assume that $g$ and $g'$ are such that $s$ fixes $g' g^{-1}$, we must check that in $Q_n(G)$ one has ${s^t}_{(g'h)^t} = {s^t}_{(gh)^t}$.
%But this is true again by~\eqref{eq:main_rel} since $(g'h)^t \cdot (gh)^{-t} = {(g'g^{-1})}^t$ is fixed by $s^t$, indeed:
%\begin{equation} \nonumber {(g'g^{-1})}^{t \cdot s^t} = {(g'g^{-1})}^{s t} = {(g'g^{-1})}^t.\end{equation}

%To check that $\mu$ is a precrossed module, it suffices to show that relation~\eqref{eq:precrossed} holds for all generators of $Q$.
%Apart from expansion of definitions this only involves the formula for conjugation of elements of a semidirect product $(a, b)^{(c, d)} = (c^{-d} \cdot a^d \cdot c^{b^{-1}d}, b^d)$:
%\begin{multline} \nonumber
%\mu\left((s_g)^{(h, t)}\right) = \mu\left({s^t}_{(gh)^t}\right) = ((gh)^{-t} (gh)^{ts^{-t}}, s^t) = ((gh)^{-t} (gh)^{s^{-1}t}, s^t) = \\ 
%= (h^{-t} \cdot (g^{-1}g^{(s^{-1})})^t \cdot h^{s^{-1}t}, s^t) = (g^{-1}g^{(s^{-1})}, s)^{(h, t)} = \mu(s_g)^{(h, t)}.
%\end{multline}
Verification of the fact that formula~\eqref{eq:action} gives a well-defined action of $G\wr S_n$ on $S_n(G)$ 
 that satisfies~\eqref{eq:precrossed} is lengthy but straightforward. Let us show that~\eqref{eq:Peiffer} holds. 
It suffices to verify Peiffer identities only for the generators of $S_n(G)$, for which it takes the form:
\begin{equation} \label{eq:Peiffer-gen} t^{-1}_h s_g t_h = {s^t}_{(gh^{-1})^t\cdot h} \text{ for all $s, t \in S_n$, $g, h\in G^n$.}\end{equation}
If we act on both sides of the above formula by $(h^{-1}, 1) \in G \wr S_n$ we obtain the equality
$t^{-1}_1 s_{gh^{-1}} t_1 = {s^t}_{(gh^{-1})^t}$.
Thus, to prove~\eqref{eq:Peiffer-gen} it suffices to show the following simpler relation:
\begin{equation} \label{eq:Peiffer-simple} t^{-1}_1 s_g t_1 = {s^t}_{g^t} \text{ for all $s, t \in S_n$, $g\in G^n$.}\end{equation}

The key step in the proof is the following lemma.
\begin{lemma} \label{lem:transp-deff} 
 The relation~\eqref{eq:Peiffer-simple} holds in the special case when $s=(ij)$ and $t=(kl)$ are two nonequal transpositions. \end{lemma}
\begin{proof} 
First of all, we immediately check that~\eqref{eq:Peiffer-simple} holds in the special case when $t$ fixes $g'\in G^n$.
Indeed, by~\eqref{eq:main_rel} we have $t_1 = t_{g'}$, hence 
\begin{equation} \nonumber t^{-1}_1 s_{g'} t_1 = t^{-1}_{g'} s_{g'} t_{g'} = (s^t)_{g'} = (s^t)_{g'^t}.  \end{equation}

Without loss of generality we may assume that $l\neq i$ and $l\neq j$.
Denote by $g'$ the vector which differs from $g$ only at $l$-th position, for which we set $g'_l = g_k$. 
Since the only nontrivial component of $g'g^{-1}$ (resp. $g'g^{-t}$) is located at $l$-th (resp. $k$-th) position,
it is fixed by $s$ (resp. $s^t)$, hence from~\eqref{eq:main_rel} we conclude that $s_g = s_{g'}$ (resp. $(s^t)_{g'} = (s^t)_{g^t}$).
Finally, since $g'$ is fixed by $t$, we get that
\begin{equation} \nonumber t^{-1}_1 s_g t_1 = t^{-1}_1 s_{g'} t_1 = (s^t)_{g'^t} = s^t_{g'} = (s^t)_{g^t}. \text{\qedhere}\end{equation} \end{proof}

\begin{proof}[Proof of~\cref{thm:cms}]
Let us show that~\eqref{eq:Peiffer-simple} holds for arbitrary transpositions $s, t \in S_n$.
It suffices to consider the case $s=t=(ij)$. 
After choosing some $k\neq i,j$ and presenting $(ij)$ as $(kj)(ik)(kj)$ we use the lemma:
\begin{equation} \nonumber (ij)^{-1}_1 (ij)_g (ij)_1 = (ij)^{-1}_1 (kj)_g (ik)_g (kj)_g (ij)_1 =
(ki)_{g^{(ij)}} (jk)_{g^{(ij)}} (ki)_{g^{(ij)}} = (ij)_{g^{(ij)}}. \end{equation}

Proposition now follows by induction on the length of permutations $s$, $t$.
\end{proof}

\subsection{An explicit presentation of $S_n(G)$}
In this section we obtain an explicit presentation of $S_n(G)$. % by means of generators and relations.
This presentation turns out to be much more economical than the original definition given in section~\ref{sec:QnG-def}.
Then via Reidemeister-Schreier method we derive a presentation for the subgroup $HS_n(G)$.

We start with the following simple lemma which is, in essence, a variant of the standard presentation of a Weyl group in terms of reflections
 with some redundant generators and relations added (cf.~\cite[Theorem~2.4.3]{Ca89}).
\begin{lemma} \label{lm:Snpres} For $n\geq 3$ The symmetric group $S_n$ admits presentation with 
transpositions as the set of generators and the following list of defining relations
(in every formula distinct letters denote distinct indices):
\begin{align}
(ij)^2 = &\, 1,         \label{Sym1} \tag{S1} \\
(ij)^{(jk)} = &\, (ik), \label{Sym2} \tag{S2} \\
[(ij), (kl)] = &\,1.    \label{Sym3} \tag{S3} \\
(ij) =&\, (ji),         \label{Sym0} \tag{S4}
\end{align}
\end{lemma}

%\begin{proof}
% Denote by $\widetilde{S}_n$ the group with the above presentation. 
% It is clear this presentation contains only those relations which already hold for the elements of $S_n$, 
%  i.\,e. there is an obvious map $\widetilde{S}_n \to S_n$.
 
% For $1\leq i\leq n-1$ set $s_i=(i,i+1)$. 
% The elements $s_i$ satisfy all the standard Coxeter relations (e\,g. from \eqref{Sym2} one easily gets the identity $(s_i \cdot s_{i+1})^3 = (i,i+2)^2 = 1$). 
% Thus, the subgroup $S$ of $\widetilde{S}_n$ generated by $s_i$ coincides with $S_n$. 
 
% Finally, to see that every generator $(ij)$ of $\widetilde{S}_n$ is contained in $S$ it remains to use induction on $|i-j|$ and the identity~\eqref{Sym2}.
%\end{proof}

Now we are ready to formulate the main result of this subsection.
\begin{prop} \label{prop:Q-pres} For $n\geq 3$ and arbitrary group $G$ the group $S_n(G)$ admits presentation with the set of generators 
$\{(ij)_a \mid i\neq j, 1\leq i,j,\leq n, a\in G\}$ and the following list of relations (as before, distinct letters denote distinct indices):
\begin{align}
(ij)_a^2 = &\, 1,                \label{Q1} \tag{SG1} \\
(ij)_a^{(jk)_b} = &\, (ik)_{ab}, \label{Q2} \tag{SG2} \\
[(ij)_a, (kl)_b] = &\,1.         \label{Q3} \tag{SG3} \\
(ij)_a =&\, (ji)_{a^{-1}}        \label{Q4} \tag{SG4} 
\end{align}
\end{prop}
\begin{proof}
Denote by $S'$ the group from the statement of the proposition.
For $1\leq i\leq n$ and $x\in G$ denote by $x[i]$ the element of $G^n$ 
 whose only nontrivial component equals $x$ and is located in the $i$-th position.

It is not hard to deduce from the definition of $S_n(G)$ and~\cref{lem:transp-deff} 
 that the formula $(ij)_a \mapsto (ij)_{a[j]}$ gives a well-defined map $\varphi\colon S'\to S_n(G)$.

Now we are going to construct the map $\psi\colon S_n(G)\to S'$ in the opposite direction. 
Using the presentation of $S_n$ given by~\cref{lm:Snpres}  we define for a fixed $g\in G^n$ the map 
 $\psi_g\colon S_n \to S'$ by $\psi_g((ij)) = (ij)_{g_i^{-1} g_j}.$
It is obvious that $\psi_g$ preserves the defining relations \eqref{Sym1}--\eqref{Sym0} of $S_n$. 
It remains to show that the equation $\psi_g(s) = \psi_h(s)$ holds whenever $g, h\in G^n$ and $s\in S_n$ satisfy the requirement of~\eqref{eq:main_rel}.

Indeed, if $hg^{-1}$ is fixed by $s$ then for every $1\leq i\leq n$ we have $(hg^{-1})_i = (hg^{-1})_{s(i)}$, or equivalently
$h_i^{-1} h_{s(i)} = g_i^{-1} g_{s(i)}$. %This already shows that the identity $\psi_g(s) = \psi_h(s)$ holds in the special case when $s$ is a transposition. 
For example, if $s$ is a cycle of length $p$, i.\,e. $s=(i_1, i_2, \ldots i_p)$ with $i_{k+1} = s(i_k)$ we get that
\begin{multline} \nonumber
 \psi_g(s) = \psi_g\left({\prod\limits_{k=1}^{p-1}(i_k, i_{k+1})}\right) = 
 \prod\limits_{k=1}^{p-1}\left(i_k, i_{k+1}\right)_{g_{i_k}^{-1} g_{i_{k+1}}} = 
 \prod\limits_{k=1}^{p-1}\left(i_k, i_{k+1}\right)_{h_{i_k}^{-1} h_{i_{k+1}}} = \psi_h(s).
\end{multline}
The proof for a general $s$ is almost the same.
%It is straightforward to deduce from the above formula a similar statement for general $s$.
Verification of the fact that $\psi$ and $\varphi$ are mutually inverse is also immediate.
\end{proof}

We now obtain a presentation of the subgroup $HS_n(G)$.
For every $i\neq j$ and $a\in G$ we define the element $h_{ij}(a) \in HS_n(G)$ as follows:
\begin{equation} \label{eq:h-def} 
h_{ij}(a) = (ij)_{a} \cdot (ij)_1. 
\end{equation}
It is not hard to show that $h_{ij}(a)$ form a generating set for $HS_n(G)$.
In fact, there is an explicit formula how an element of $HS_n(G)$ originally expressed through $(ij)_{a}$'s can be rewritten in terms of $h_{ij}(a)$.
Indeed, if $h$ lies in $HS_n(G)$ and is written as $\prod_{k=1}^N(i_k j_k)_{a_k}$ for some $i_k\neq j_k$ and $a_k\in G$ then it can be rewritten as follows:
\begin{equation} \label{eq:rp} \tag{$\tau$}
 h = \prod_{k=1}^N h_{\sigma_k(i_k), \sigma_k(j_k)}(a_k),\text{ where } \sigma_k=\prod_{s=1}^{k-1} (i_s j_s) \in S_n. \end{equation}

We briefly recall the notion of a {\it rewriting process} given in~\cite[\S~2.3]{MKS76}.
If $G$ is a group presented by generators $a_\nu$ and relations $R_{\mu}(a_{\nu})$ and $H$ is its subgroup with a generating set $J_i(a_\nu)$ then
 a {\it rewriting process for $H$} is a function which maps every word $u$ in alphabet $a_\nu$ to a word $v$ in alphabet $s_i$ such that
 $u$ and $v[s_i:=J_i]$ define the same element of $G$ whenever $u$ represents an element of $H$.

With this terminology, the mapping~\eqref{eq:rp} defined above is a rewriting process for the subgroup $HS_n(G)$.
Since it does not arise as a rewriting process corresponding to a coset representative function,
this process is {\it not} a Reidemeister rewriting process in the sense of~\cite[\S~2.3]{MKS76}.
However, it still satisfies the following two key properties of a Reidemeister rewriting process (cf. with (v) and (vi) of~\cite[\S~2.3]{MKS76}): 
\begin{itemize}
 \item if $U$ and $U^*$ are freely equal words in $(ij)_a$ then $\tau(U)$ and $\tau(U^*)$ are also freely equal words in $h_{ij}(a)$;
 \item if $U_1$ and $U_2$ are two words in $(ij)_a$ which define elements of $HS_n(G)$ then the words $\tau(U_1U_2)$ and $\tau(U_1) \tau(U_2)$ are equal.
\end{itemize}
Using these two properties and repeating the arguments used in the proof of~\cite[Theorem~2.8]{MKS76}
one can simplify the generic presentation of $HS_n(G)$ given by~\cite[Theorem~2.6]{MKS76} and obtain the following.
\begin{lemma} \label{lm:h-gen}

 For $n\geq 3$ the group $HS_n(G)$ admits presentation on the generators $h_{ij}(a)$ with the following two families of defining relations:
 \begin{align}
  h_{ij}(a) = &\, \tau\left((ij)_a \cdot (ij)_1\right); \label{eq:tau1} \\
  \tau(KRK^{-1}) = &\, 1, \label{eq:tau2} 
 \end{align}  
 where $R$ varies over relations of~\cref{prop:Q-pres} and $K$ is any word in $(ij)_1$, $i\neq j$.
\end{lemma}

From~\eqref{eq:tau1} one immediately obtains the equality $h_{ij}(1)=1$, $i\neq j$.
Thus, if we denote by $\sigma$ the permutation corresponding to a word $K$ and let $S_n$ act on $h_{ij}(a)$'s in the natural way
 we will get that the word $\tau(KRK^{-1})$ is equivalent to ${}^{\sigma}\tau(R)$ (modulo relations $h_{ij}(1)=1$). 

Since the relations from~\cref{prop:Q-pres} are respected by the action of $S_n$,
 only relations of the form $\tau(R)=1$ are, in fact, needed for the presentation of $HS_n(G)$.
Writing down what $\tau(R)$ is for each of \eqref{Q1}--\eqref{Q4} we get the following.
 
\begin{prop} \label{prop:HSpres} For $n\geq 3$ the group $HS_n(G)$ admits presentation with generators $h_{ij}(a)$ and the following list of relations:
\begin{align}
h_{ij}(1)                     = &\, 1,              \tag{HS0} \label{H0} \\
h_{ij}(a) h_{ji}(a)           = &\, 1,              \tag{HS1} \label{H1} \\
h_{jk}(b) h_{ik}(a) h_{ij}(b) = &\, h_{ik}(ab),     \tag{HS2} \label{H2} \\
[h_{ij}(a), h_{kl}(b)]        = &\, 1,              \tag{HS3} \label{H3} \\
h_{ij}(a)^{-1}                = &\, h_{ij}(a^{-1}). \tag{HS4} \label{H4}
\end{align}
\end{prop}

\begin{comment}
\begin{proof}
 Again we work with $Q_n(G)$ presented as in~\cref{prop:Q-pres}. 
 By~\cite[Theorem~2.6]{MKS76} the group $HQ_n(G)$ can be presented by generators $HX_n(G)$ and the following four families of relations:
\begin{align}
h_{ij}(a)              = &\, \tau((ij)_a \cdot (ij)_1)     \label{Th261} \\
\tau(U)                = &\, \tau(U^*)                     \label{Th262} \\
\tau(U_1 \cdot U_2)    = &\, \tau(U_1) \cdot \tau(U_2)     \label{Th263} \\
\tau(WRW^{-1})              = &\, 1.                       \label{Th264}
\end{align}
Here $U$, $U^*$, $U_1$ and $U_2$ are words in $X_n(G)$ defining some elements of $HQ_n(G)$ such that $U$ and $U^*$ are freely equal,
$W$ is an arbitrary word in $X_n(G)$ and $R$ is any of the relations~\eqref{Q0}--\eqref{Q3}.

Using the rewriting process~\eqref{eq:rewr-proc} we rewrite the relation~\eqref{Th261} as \[h_{ij}(a) = h_{ij}(a) \cdot h_{ji}(1).\] 
It is clear that this relations implies~\eqref{H00}.

The relations~\eqref{H0}--\eqref{H3} are corollaries of~\eqref{Th264} in the special case $W=1$.
Indeed, if $R_1 = (ij)_a (ij)_a$ is the word corresponding to relation~\eqref{Q1} then again using the rewriting process~\eqref{eq:rewr-proc} we get that
\[ 1 = \tau(R_1) = h_{ij}(a) \cdot {}^{(ij)}\! h_{ij}(a) =  h_{ij}(a) h_{ji}(a).\]
Thus, we obtain relation~\eqref{H1}. Similarly, if we start from the word 
\[R_2 = (jk)_b \cdot (ij)_a \cdot (jk)_b \cdot (ik)_{ab}\]
corresponding to relation~\eqref{Q2} we come to relation
\begin{multline} \nonumber
 1 = \tau(R_2) = h_{jk}(b) \cdot {}^{(jk)}\!h_{ij}(a) \cdot {}^{(jk)(ij)}\!h_{jk}(b) \cdot {}^{(jk)(ij)(jk)}\! h_{ik}(ab) = \\
 = h_{jk}(b) \cdot h_{ik}(a) \cdot h_{ij}(b) \cdot h_{ki}(ab),
\end{multline}
which is a reformulation of~\eqref{H2}.
The check for the two remaining relations is similar and we leave it to the reader.

By~\cref{rm:tau-property} we have $\tau(WRW^{-1}) = \tau(W) \cdot {}^\sigma\!\tau(R) \cdot {}^\sigma\tau(W^{-1})$ for $\sigma=\pi(W)$.
The central factor ${}^\sigma\!\tau(R)$ is already included into the list of relations~\eqref{H0}--\eqref{H3}.
It is also clear that $\tau(W) {}^\sigma\tau(W^{-1})$ can be contracted to identity bu successive application of~\eqref{H1}.
Thus the relations obtained from~\eqref{Th264} in the case when $W$ is nontrivial are consequences of relations from the statement of the proposition.

The same is true for the relations obtained from~\eqref{Th262}--\eqref{Th263}.
For example, if $U$ is obtained from $U^*$ by insertion or deletion of $(ij)_a \cdot (ij)_a$ then by~\cref{rm:tau-property}
$\tau(U)$ is obtained from $\tau(U^*)$ by insertion or deletion of $h_{kl}(a) \cdot h_{lk}(a)$ for some $k\neq l$.
Since $\pi(U_1)$ is a trivial permutation, it also follows from~\cref{rm:tau-property} that expressions in both sides of~\eqref{Th263} are equal words.
\end{proof}

\subsection{Computation of $\pi_1$ and $\pi_2$}

Now let us compute the cokernel of $\mu$.
We claim that $\mathrm{Im}(G) = D_n(G) \ltimes S_n$, where $D_n(G)$ denotes the subgroup of $G^n$ consisting of vectors
 $(g_1,\ldots, g_n)$ for which the product $g_1\cdot \ldots \cdot g_n$ lies in $[G, G]$. 
The inclusion $\subseteq$ is immediately obvious from the definition of $\mu$.
To prove the inverse inclusion notice that $D_n(G)$ is generated by elements $d_{ij}(g)$, $i\neq j$, $g\in G$ (cf.~\cite[\S~2]{Reh78}).
Here $d_{ij}(g)$ is the element of $G^n$ defined as follows: 
 the $k$-th component of $d_{ij}(g)$ equals $g$ for $k=i$, $g^{-1}$ for $k=j$ and is $1$ otherwise.
It is not hard to see that the cokernel of $\mu$ is $\HH_1(G, \ZZ) = G_{ab}$.
\end{comment}
% To see this first multiply $(g_1,\ldots, g_n)\in D_n(G)$ by suitable $d_{ij}(g)$'s so that it is reduced
% to an element of the form $(h, 1, \ldots, 1)$ with $h\in [G, G]$. It remains to see that $([a, b], 1, \ldots, 1)$ can be presented as a commutator $[h_{12}(a), h_{13}(b)]$.

\section{Relationship with extensions of type \texorpdfstring{$\mathfrak{H}_n(G)$}{Hn(G)}}
The group $S_n(G)$ defined in the previous section turns out to be directly related with the theory
 of extensions of type $\mathfrak{H_n}$ developed by Rehmann in~\cite{Reh78}.
It turns out, that some of the relations from~\cref{prop:HSpres} can be used to give a simpler presentation for the ``universal'' extension $H_n(G)$.

\subsection{Extensions of type $\mathfrak{H}_n(G)$ and $\mathfrak{U}(G)$} \label{ssec:extensions}
We start by reviewing the material of \S~1--3 of~\cite{Reh78}. 
Let $n \geq 3$ be a natural number. By definition, the group $H_n(G)$ is given by generators
$h_{ij}(u)$, $u\in G$, $i\neq j$ and the following relations (cf. \cite[H1--H5~of~\S~2]{Reh78}):
\begin{align}
h_{ij}(u) h_{ji}(u)                = &\, 1,                        &                     \tag{H1} \label{RH1} \\
h_{ij}(u) h_{ki}(u) h_{jk}(u)      = &\, 1,                        &                     \tag{H2} \label{RH2} \\
h_{ij}(u) h_{ik}(v) h_{ij}(u)^{-1} = &\, h_{ik}(uv) h_{ik}(u)^{-1},& \text{for } j\neq k \tag{H3} \label{RH3} \\
h_{ij}(u) h_{kj}(v) h_{ij}(u)^{-1} = &\, h_{kj}(vu) h_{kj}(u)^{-1},& \text{for } i\neq k \tag{H4} \label{RH4} \\
[h_{ij}(u), h_{kl}(v)]             = &\, 1.                        &                     \tag{H5} \label{RH5} \end{align}
Denote by $D_n(G)$ the subgroup of $G^n$ consisting of vectors
 $(g_1,\ldots, g_n)$ for which the product $g_1\cdot \ldots \cdot g_n$ lies in $[G, G]$.
There is a surjective group homomorphism $H_n(G) \twoheadrightarrow D_n(G)$ sending $h_{ij}(g)$ to $d_{ij}(g)$.
Here $d_{ij}(g)$ stands for the element of $G^n$ whose
 $i$-th component equals $g$, $j$-th component equals $g^{-1}$ and all other components are trivial.

By definition, {\it an extension of type $\mathfrak{H}_n(G)$} is an extension $H$ of $D_n(G)$ that is also a quotient of $H_n(G)$, i.\,e. 
 the extension that fits into the following diagram.
\[ \xymatrix{ H_n(G) \ar@{->>}[rd] \ar@{->>}[d] & \\ H \ar@{->>}[r] & D_n(G)} \]
%Any $\mathfrak{H}_n(G)$-extension is central, see~\cite[Proposition~2.3]{Reh78}.
We now recall the notion of an extension of type $\mathfrak{U}(G)$ given by Rehmann in~\cite[\S~1]{Reh78}.
Let $G$ be a group. Denote by $U(G)$ the group presented by generators $(u, v)$, $u,v\in G$ and relations:
\begin{align}
 ({}^{u} v, {}^{u}w) (u,  w) = &\, (uv, w), \tag{U1} \label{U1} \\
 (u,  vw) (v,  wu) (w,  uv)  = &\, 1.       \tag{U2} \label{U2}
\end{align}
There is a left action of $G$ on $U(G)$ given by ${}^x (u, v) = ({}^{x}u, {}^{x}v).$
Equivalently, $U(G)$ can be defined by the following relations, see~\cite[p.~8]{De76} (where $U(G)$ is denoted $(G, G)$).
\begin{align} 
 (u, v) (v, u)     = &\, 1,          \label{U4} \\
 (u, v) \ {}^v(u, w) = &\, (u, vw),  \label{U6} \\
 {}^u(v, w)(w, v)  = &\, (u, [v, w]).\label{U9} \end{align}
 
It is clear from the definition that $U(G)$ is a quotient of the nonabelian tensor square $G\otimes G$ and that
the map $(u, v) \mapsto [u, v]$ defines a $G$-equivariant map $U(G) \twoheadrightarrow [G, G]$.
By definition, an {\it extension of type $\mathfrak{U}(G)$} is simply a quotient of $U(G)$
 that fits into the following commutative diagram with $G$-equivariant arrows.
\[ \xymatrix{ U(G) \ar@{->>}[rd] \ar@{->>}[d] & \\ U \ar@{->>}[r] & [G, G]} \]

\begin{comment}
There is a correspondence between extensions of type $\mathfrak{H}_n(G)$ and $\mathfrak{U}(G)$.
One can obtain a $\mathfrak{U}(G)$-extension from given $\mathfrak{H}_n(G)$-extension via restriction.
Indeed, let $H$ be an extension of type $\mathfrak{H}_n(G)$ and $k$ be arbitrary number $1\leq k\leq n$.
Denote by $\iota_k$ the inclusion map $[G, G] \to D_n(G)$ that inserts an element $g \in [G, G]$ at the $k$-th position.
Then the corresponding extension $U$ is simply the pull-back of $H$ with respect to $\iota_k$.
\[ \xymatrix{ U \ar[d] \ar@{->>}[r]^{\pi_U} & [G, G] \ar[d]^{\iota_k} \\ H \ar@{->>}[r]^{\pi_H} & D_n(G).} \]

In more down-to-earth terms $U$ can be described as the subgroup of $H$ generated by 
symbols $c_{k}(u, v)=h_{kj}(u) \cdot h_{kj}(v) \cdot h_{kj}(vu)^{-1}$ 
 (here $j$ is any index not equal $k$, $c_k(u,v)$ does not depend on $j$, see~\cite[Proposition~2.1]{Reh78}).
It can be shown that $U$ is an extension of type $\mathfrak{U}(G)$ with kernel~$\mathrm{Ker}(\pi_U)$ 
 isomorphic to $\mathrm{Ker}(\pi_H)$, see~\cite[Propositions~2.2--2.3]{Reh78}.
In~\cite[\S~3]{Reh78} Rehmann also describes the inverse construction which assign to every $\mathfrak{U}(G)$-extension
 $U\twoheadrightarrow [G, G]$ and a number $n\geq 3$ an extension $H$ of type $\mathfrak{H}_n(G)$ that fits into the same pull-back diagram.
\end{comment}
% TODO: Is this correspondence one-to-one?
% TODO: Does $G\otimes G$ correspond to $H_n(G)$ via this construction (and vice-versa)?

\subsection{A simpler presentation of $H_n(G)$}
The aim of this subsection is to obtain a presentation of $H_n(G)$ that is simpler than the original presentation: 4 instead of 5 relations that are also shorter. 
Our main result is the following.
\begin{prop} For $n\geq 4$ the group $H_n(G)$ admits presentation with generators $h_{ij}(a)$, $1\leq i, j\leq n$, $i\neq j$, $a\in G$ and relations \eqref{H0}--\eqref{H3}. \end{prop}
The proof is based on a series of technical lemmas whose proofs is often identical to those found in Rehmann's paper~\cite{Reh78}.
For $u, v\in G$ we define the following two symbols:
\[c_{ij}(u,v)=h_{ij}(u)h_{ij}(v)h_{ij}(vu)^{-1}, c'_{ij}(u,v)=h_{ij}(u)h_{ij}(v)h_{ij}(uv)^{-1}.\]
Notice that~\eqref{RH4} implies $h_{ij}(1)=1$ therefore $c_{ij}(u, u^{-1}) = c'_{ij}(u, u^{-1})$.
Let us show that one of the relations~\eqref{RH3}, \eqref{RH4} can be excluded from the definition of $H_n(G)$.
\begin{lemma} \label{item-lem33} If one excludes relation~\eqref{RH3} from the list of defining relations for the group $H_n(G)$, $n\geq 3$,
 the following facts still remain true:
 \begin{lemlist}
\item \label{item-lem33-cntr} The elements $c_{ij}(u, u^{-1})$ are central in $H_n(G)$;
\item \label{item-lem33-comm} One has $c'_{ij}(u, v) = [h_{ij}(u), h_{kj}(v)]$;
\item \label{item-lem33-conj}  One has ${}^{h_{ij}(w)}c_{kj}'(u, v) = c_{kj}'(u, w)^{-1} c_{kj}'(u, vw)$;
\item \label{item-lem33-conj2} One has ${}^{h_{ij}(w)} c'_{ij}(u, v) = c'_{ij}(uw, v) c'_{ij}(w, v)^{-1}$
%\item \label{item-lem33-uum}  One has $c_{ij}(u, u^{-1}) = c_{ij}(u, u)^{-1}$;
%\item \label{item-lem33-um}  One has $c_{ij}(u, u^{-1}) = c_{ij}(u^{-1}, u)$.
 \end{lemlist}
\end{lemma}
\begin{proof}
First one shows using~\eqref{RH4} that $h_{kj}(v)$ centralizes $c_{ij}(u, u^{-1})$ (cf. with the proof of~\cite[Lemma~2.1(2)]{Reh78}).
Since in any group $[a, b]=1$ implies $[a^{-1}, b] = [a, b^{-1}] = [a^{-1}, b^{-1}] = 1$ we get that $c_{ij}(u, u^{-1})$ also centralizes $h_{kj}(v)^{-1} = h_{jk}(v)$ and
 $c_{ij}(u^{-1}, u)^{-1} = c_{ji}(u, u^{-1})$ centralizes both $h_{kj}(v)$ and $h_{jk}(v)$.
This together with~\eqref{RH2} and~\eqref{RH5} imply that $c_{ij}(u, u^{-1})$ centralize all the generators of $H_n(G)$ and hence lie in the center of $H_n(G)$.

The second and third assertions are straightforward corollaries of~\eqref{RH4}.
The fourth assertion follows from the third one:
\[{}^{h_{ij}(w)} c'_{ij}(u, v) = {}^{h_{ij}(w)} c'_{kj}(v, u)^{-1} = (c'_{kj}(v, w)^{-1} c'_{kj}(v, uw))^{-1} = c'_{ij}(uw, v) c'_{ij}(w, v)^{-1}.\]
%Fifth assertion follows from the first and third one (letting $w=u$, $v=u^{-1}$).

%For any distinct $i$, $j$ and $k$ we have $c'_{ij}(u, v)^{-1} = c'_{kj}(v, u)$, therefore by the fifth assertion we have:
%\begin{multline} \nonumber
% c_{ij}(u, u^{-1}) = c_{kj}(u^{-1}, u)^{-1} = c_{kj}(u^{-1}, u^{-1}) = c_{ij}(u^{-1}, u^{-1})^{-1} = c_{ij}(u^{-1}, u). \qedhere
%\end{multline}
\end{proof}

\begin{lemma}
If one excludes relation~\eqref{RH3} from the list of defining relations for the group $H_n(G)$, $n\geq 3$, the following statements turn out to be equivalent:
\begin{enumerate}
\item \label{item1} \eqref{RH3} holds;
%\item \label{item2} for $j\neq k$ one has ${}^{h_{ij}(u)} h_{ik}(u) = h_{ik}(u^2) h_{ik}(u)^{-1}$;
%\item \label{item3} one has $h_{ij}(u^{-1}) h_{ij}(u)^{-1} = h_{ij}(u^2)^{-1}$;
%\item \label{item4} one has $c'_{ij}(u, u^{-1})^2 = 1$;
%\item \label{item5} one has $c'_{ij}(u, v)^{-1} = c'_{ij}(v, u)$;
%\item \label{item6} symbols $c'_{ij}(u, v)$ do not depend on the choice of index $i$;
%\item \label{item5} symbols $c'_{ij}(u, u^{-1})$ are independent of $i$ and $j$;
\item \label{item4} one has $c'_{ij}(u, v)^{-1} = c'_{ij}(v, u)$;
\item \label{item5} symbols $c'_{ij}(u, v)$ do not depend on $i$;
\item \label{item5} one has $c'_{ij}(u, vw) = c'_{ij}(wu, v) \cdot c'_{ij}(uv, w)$;
\item \label{item6} one has $c'_{ij}(u, vu^{-1}) = c'_{ij}(uv, u^{-1})$.
%  \item Symbols $c_{ij}(u,v)$ do not depend on the choice of $j$ (resp. $c'_{ij}(u, v)$ do not depend on the choice of $i$).
%  \item Symbols $c_{i*}(u, v)$ (resp. $c'_{*j}(u, v)$) satisfy identity~\eqref{U2}, in particular, one has $c_{i*}(ab, a^{-1}) = c_{i*}(a, ba^{-1})$ (resp. $c'()$).
 %\item one has $h_{ij}(1)=1$;
 %\item for distinct $i,j$ and $k$ one has $c_{ij}(u, v) = [h_{ij}(u), h_{ik}(v)]$; (resp. $c'_{ij}(u, v) = [h_{ij}(u), h_{kj}(v)]$),
 %      moreover $c_{ij}(u,v)^{-1} = c_{ik}(v, u)$ (resp. $c'_{ij}(u, v)^{-1} = c'_{kj}(v, u)$);
 %\item one has ${}^{h_{ij}(w)}c_{ik}(u, v) = c_{ik}(u, w)^{-1} c_{ik}(u, wv)$ (respectively, ${}^{h_{ij}(w)}c_{kj}'(u, v) = c_{kj}'(u, w)^{-1} c_{kj}'(u, vw)$);
 %\item $c_{ij}(u, u^{-1}) = c'_{ij}(u, u^{-1})$ is a central element in $H_n(G)$ for any $u\in G$;
\end{enumerate}
\end{lemma}
\begin{proof}
Implications $(1) \implies (2) \implies (3) \implies (4)$ are essentially contained in the proof of~\cite[Lemmas~2.1-2.2]{Reh78}.
Implication $(4) \implies (5)$ is trivial.

We now prove $(5) \implies (1)$. Notice that~\eqref{RH4} implies ${}^{h_{ij}(u)^{-1}}h_{ik}(v) = h_{ik}(u)^{-1} h_{ik}(vu)$, therefore
using~\cref{item-lem33-cntr} we get that ${}^{h_{ij}(u)}h_{ik}(v) = {}^{c_{ij}(u, u^{-1}) h_{ij}(u^{-1})^{-1}}h_{ik}(v) = h_{ik}(u^{-1})^{-1} h_{ik}(vu^{-1}).$
Thus,~\eqref{RH3} turns out to be equivalent to equality $h_{ik}(uv) h_{ik}(u)^{-1} = h_{ik}(u^{-1})^{-1} h_{ik}(vu^{-1})$, or what is the same
\[c'_{ik}(u^{-1}, uv) = h_{ik}(u^{-1}) h_{ik}(uv) =  h_{ik}(vu^{-1}) h_{ik}(u) = c'_{ik}(vu^{-1}, u).\]
It is clear that the last equality is an equivalent reformulation of $(5)$.
\end{proof}

\begin{comment}
Implication $(1) \implies (2) $ is obtained by setting $u=v$. 

Implication $(2) \implies (3)$ is what is really proved before formula~(6)~on~\cite[p.~86]{Reh78}.

Implication $(3) \implies (4)$ is obtained via the same calculation as in formula~(8) on page~96 ibid.
The reader should refer to (1) and (4) of Lemma~\ref{item-lem33} instead of the corresponding assertions of~\cite[Lemma~2.1]{Reh78}.

Let us show $(4) \implies (5)$. By (4), \eqref{RH1} and~\cref{item-lem33-um} we have 
\begin{equation} c'_{ij}(u, u^{-1}) = c'_{ij}(u, u^{-1})^{-1} = c'_{ji}(u^{-1}, u) = c'_{ji}(u, u^{-1}). \end{equation}
  Moreover, for distinct $i$,$j$ and $k$ we have 
  \begin{equation} \nonumber c_{ij}(u, u^{-1}) = c_{kj}(u^{-1}, u)^{-1} = c_{kj}(u^{-1}, u) = c_{kj}(u, u^{-1}).\end{equation}
Together these two equalities imply (5).

Let us show $(5) \implies (6)$. Using appropriate assertions of \cref{item-lem33} we can partially mimick Rehmann's derivation of~\eqref{U2} 
 (cf. \cite[Lemma~2.2]{Reh78}) with the difference that now we cannot refer to~\cite[Proposition~2.1]{Reh78}.
\begin{multline} \nonumber
 c'_{ij}(u, vw) = [h_{ij}(u), h_{kj}(vw)] = [h_{ij}(u), c'_{ij}(w, v) h_{kj}(v) h_{kj}(w)] = \\
 = [h_{ij}(u), c'_{ij}(w, v)] \cdot {}^{c'_{ij}(w, v)} \! \left([h_{ij}(u), h_{kj}(v)] \cdot {}^{h_{kj}(v)}[h_{ij}(u), h_{kj}(w)]\right) = \\
 = {}^{h_{ij}(u)} c'_{ij}(w, v) \cdot c'_{ij}(u, v) \cdot {}^{h_{kj}(v)} c'_{ij}(u, w) \cdot c'_{ij}(w, v)^{-1} = \\
 = c'_{ij}(wu, v) \cdot {}^{h_{kj}(v)}c'_{ij}(u, w) \cdot c'_{ij}(w, v)^{-1} = \\
 = c'_{ij}(wu, v) \cdot c'_{kj}(uv, w) \cdot c'_{kj}(v, w)^{-1} \cdot c'_{ij}(w, v)^{-1} = c'_{ij}(wu, v) \cdot c'_{kj}(uv, w).
\end{multline}

Setting $w=u^{-1}$ and using our assumption we get
By our assumption 
\begin{multline}
c'_{ij}(u, vu^{-1}) = 
{}^{h_{kj}(v)} c'_{ij}(u, u^{-1}) c'_{ij}(u^{-1}, v)^{-1} = \\
{}^{h_{kj}(v)} c'_{kj}(u, u^{-1}) c'_{ij}(u^{-1}, v)^{-1} = 
c'_{kj}(uv, u^{-1})c'_{kj}(v, u^{-1})^{-1} c'_{ij}(u^{-1}, v)^{-1} 
\end{multline}
\end{comment}
                                             
\begin{comment}
 \begin{multline}
  c_{ij}(u, vw) = [h_{ij}(u), h_{ik}(vw)] = [h_{ij}(u), c_{ij}(v, w) h_{ik}(w)h_{ik}(v)] = \\
   = [h_{ij}(u), c_{ij}(v, w)] \cdot {}^{c_{ij}(v, w)} ([h_{ij}(u), h_{ik}(w)] \cdot {}^{h_{ik}(w)}[h_{ij}(u), h_{ik}(v)]) = \\
   = {}^{h_{ij}(u)} c_{ij}(v, w) \cdot c_{ij}(u, w) \cdot {}^{h_{ik}(w)} c_{ij}(u, v) \cdot c_{ij}(v, w)^{-1} = \\
   = c_{ij}(uv, w) \cdot {}^{h_{ik}(w)} c_{ij}(u, v) \cdot c_{ij}(v, w)^{-1}.
 \end{multline}

 The first three assertions easily follow from~\eqref{RH3} (resp.~\eqref{RH4}).
 
 We only prove fourth assertion under the assumption that~\eqref{RH4} is skipped (the proof for the other case is similar).
 It suffices to show that $h_{ij}(u)h_{ij}(u^{-1})$ centralizes all generators $h_{kl}(v)$ of $H_n(G)$.
 In view of~\eqref{RH2} and~\eqref{RH5} it suffices to only consider the case when $h_{ij}(u)$ and $h_{kl}(v)$ have exactly one common index.
 Suppose, for example, that $k=i$, then by~\eqref{RH3} we have
 \[{}^{h_{ij}(u) h_{ij}(u^{-1})} h_{il}(v) = {}^{h_{ij}(u)}(h_{il}(u^{-1}v) h_{il}(u^{-1})^{-1}) = h_{il}(v),\]
 In any group $[a, b]=1$ implies $[a^{-1}, b] = [a, b^{-1}] = [a^{-1}, b^{-1}] = 1$ therefore $c_{ij}(u, u^{-1})$ also centralizes $h_{ik}(v)^{-1} = h_{ki}(v)$ and
 $c_{ij}(u^{-1}, u)^{-1} = c_{ji}(u, u^{-1})$ centralizes both $h_{ik}(v)$ and $h_{ki}(v)$.

\begin{multline} {}^{h_{ij}(u)} c_{ij}(v, w) = {}^{h_{ij}(u)}c_{ik}(w, v)^{-1} = c_{ik}(w, uv)^{-1} c_{ik}(w, u) = c_{ij}(uv, w) c_{ij}(u, w)^{-1}. \end{multline} 

$h_{ik}(vw) = c_{ij}(v, w) h_{ik}(w)h_{ik}(v)$
 
 
Substituting $v = u^{-1}$ we get
\begin{multline}
   c_{ij}(u, u^{-1}w) =  {}^{h_{ik}(w)} c_{ij}(u, u^{-1}) c_{ij}(u^{-1}, w)^{-1} = {}^{h_{ij}(w)} c_{ij}(u, u^{-1}) c_{ij}(u^{-1}, w)^{-1} = \\
    = c_{ij}(wu, u^{-1}) c_{ij}(w, u^{-1})^{-1} c_{ij}(u^{-1}, w)^{-1}
\end{multline}

\end{proof}
\begin{rem}
 In the case $n=3$ the above argument does not work. 
 TODO: Can we provide a counterexample?
\end{rem}

\begin{lemma} Relations \eqref{RH1} and \eqref{RH4} are equivalent in the presence of \eqref{RH1}, \eqref{RH2} and \eqref{RH5}. \end{lemma}
\end{comment}


\begin{comment}
We mention an example which plays a key role in the sequel.
\begin{example}
Denote by $\Lambda^2(G)$ the group defined by generators $c(x, y)$, $a, b\in G$ and the following relations
 \begin{align}
c(x, x)                   = &\, 1,          \label{R1} \\
c(x, y) \cdot c(y, x)     = &\, 1,          \label{R2} \\
{}^z\!c(x,y) \cdot c(z,y) = &\, c(zx,y),    \label{R3} \\
{}^z\!c(x,y) \cdot c(y,x) = &\, c(z,[x,y]). \label{R4}
\end{align}
By a classical result of C.~Miller there is an exact sequence (see~\cite{Mi52}):
\begin{equation} \label{eq:Miller} \xymatrix{1 \ar[r] & \mathrm{H}_2(G,\mathbb{Z}) \ar[r] &  \Lambda^2(G) \ar[r] &  [G, G] \ar[r] & 1.} \end{equation}

It can be shown that the defining relations~\eqref{R2}--\eqref{R4} of $\Lambda^2(G)$ are equivalent
to~\eqref{U1}--\eqref{U2}, see e.\,g. the discussion on page~7 of~\cite{De76}.
Thus, the group $\Lambda^2(G)$ is a $\mathfrak{U}(G)$-extension with only one additional family of relations imposed, namely~\eqref{R1}.
\end{example}
\end{comment}

\begin{comment}
\begin{example} \label{ex:HQ}
 The extension $HQ_n(G)\twoheadrightarrow D_n(G)$ from~\eqref{eq:comm-diagram} is an $\mathfrak{H}_n(G)$-extension.
 To see this notice, first, that relations~\eqref{RH1} and~\eqref{H1} (resp.~\eqref{RH5} and~\eqref{H3}) are identical.
 Relation~\eqref{RH2} follows from~\eqref{H00} and~\eqref{H2}.
 Relation~\eqref{RH3} is equivalent to~\eqref{H2} in the presence of~\eqref{RH2}.
 Finally, relation~\eqref{RH4} is implied by~\eqref{RH3} and~\eqref{H0}.
\end{example}
\begin{example}
 For $n\geq 3$ we denote by $H_n(\Lambda^2G)$ the group obtained from the ``universal`` $\mathfrak{H}_n(G)$-extension $H_n(G)$ by modding out symbols $c_n(x,x)$.
 It is easy to see that $\mathfrak{U}(G)$-extension obtained from $H_n(\Lambda^2G)$ is precisely $\Lambda^2(G)$.
\end{example}
\end{comment}

\begin{comment}
 It is clear that $\mathfrak{U}(G)$-extensions and $\mathfrak{H}_n(G)$-extensions form categories $\mathfrak{U}\mathrm{Ext}(G)$ and $\mathfrak{H}_n\mathrm{Ext}(G)$.
 The restriction $H\mapsto U(H)$ clearly defines a functor $U(-)\colon \mathfrak{H}_n\mathrm{Ext}(G) \to \mathfrak{U}\mathrm{Ext}(G)$.
 It can be shown that the construction from the previous proposition is also functorial and defines a functor 
  $H_n(-)\colon \mathfrak{U}\mathrm{Ext}(G) \to \mathfrak{H}_n\mathrm{Ext}(G)$. These two functors establish an equivalence of categories 
  $\mathfrak{U}\mathrm{Ext}(G)$ and $\mathfrak{H}_n\mathrm{Ext}(G)$.
\end{comment}

\begin{comment}
Now we are ready to formulate the main result of this section.
To avoid confusion we reserve notation $h_{ij}(a)$ for elements of $HQ_n(G)$ and denote elements of $H_n(\Lambda^2G)$ by $\hh_{ij}(a)$.  
\begin{prop} \label{thm:main} For $n\geq 3$ the extensions $HQ_n(G)$ and $H_n(\Lambda^2G)$ are isomorphic. \end{prop}
\begin{proof} 
 First of all we want to show that the mapping $\phi(h_{ij}(a)) = \hh_{ij}(a)$ gives a well-defined map $\phi\colon HQ_n(G) \to H_n(\Lambda^2G)$.
 Since $H_n(\Lambda^2(G)$ is an $\mathfrak{H}_n(G)$-extension the elements~$\hh_{ij}(a)$ satisfy relations~\eqref{RH1}--\eqref{RH5}.
 We need to check that $\hh_{ij}(a)$ satisfy~\eqref{H00}--\eqref{H3}. 
 Relations~\eqref{H1} and~\eqref{H3} are automatically true for $\hh_{ij}(a)$ (cf. with~\eqref{RH1},\eqref{RH5}).
 It is also easy to see that~\eqref{H2} is a consequence of~\eqref{RH2} and~\eqref{RH3}.
 
 It remains to check that~\eqref{H00}--\eqref{H0} are also true for $\hh_{ij}(a)$.
 In any $\mathfrak{U}(G)$-extension one has $c_n(u, u) = c_n(u, u^{-1})$, see the first formula on page~87 of~\cite{Reh78}.
 %Notice that by~\eqref{U1} and~\eqref{R1} we have the following identities for elements of $\Lambda^2G$:  
 %  \[c(x^{-1}, x) = {}^x\!c(x^{-1}, x) \cdot c(x, x) = c(x x^{-1}, x) = c(1, x).\]
 %On the other hand, by~\eqref{U2} and~\eqref{R2} we have \[ 1 = c(1, x)\cdot c(1, x) \cdot c(x, 1) = c(1, x).\]
 From this identity and the definition of the symbol $c_n(u,v)$ we get that
 \[\hh_{nj}(x) \cdot \hh_{nj}(x^{-1}) \cdot \hh_{nj}(1)^{-1} = 1,\]
 from which it follows that the elements $\hh_{nj}(u)$ satisfy relations~\eqref{H00}--\eqref{H0} for all $j\neq n$.
 Using~\eqref{RH1}--\eqref{RH2} it is not hard to deduce from this that~\eqref{H00}--\eqref{H0} hold for all $\hh_{ij}(a)$, $i\neq j$.
 
 To construct the inverse map $\psi\colon H_n(\Lambda^2G) \to HQ_n(G)$ it suffices to check that $c_n(u, u) = 1$.
 But this follows from~\eqref{H00}--\eqref{H0}:
 \[c_n(u, u) = c_n(u, u^{-1}) = h_{nj}(u) \cdot h_{nj}(u^{-1}) \cdot h_{nj}(1)^{-1} = 1. \qedhere\] 
\end{proof}

Thus we obtain the following result.
\begin{cor}
  For $n\geq 3$ the group $Q_n(G)$ is a central extension of $G \wr S_n$ isomorphic to $H_n(\Lambda^2G)\rtimes S_n$.
  The kernel of $\mu$ is isomorphic to $\HH_2(G, \mathbb{Z})$.  
\end{cor}
\end{comment}


\section{Topological motivation} \label{sec:topo-prelim}
\subsection{Weak equivalence of $F_{h_\infty}$ and $h_\infty^{-1}(0)$} \label{sec:topo-weak-equiv}

\begin{lemma} If $X$ is fibrant and connected then $F_{h_\infty}$ and $h^{-1}(0)$ are weakly equivalent. \end{lemma}
From the proof of~\cite[Lemma~10.1]{Po17} it follows that the following square of abelian groups is cocartesian in the case $Y$ is fibrant and connected.
\begin{equation} \xymatrix{ \ZZ[\catname{sSets}(X, Y)] \ar[r]  \ar@{->>}_{\alpha}[d] & \catname{sSets}(X, A(Y)) \ar@{->>}_{\beta}[d]  \\
                            \ZZ[\catname{hsSets}(X, Y)] \ar[r] & \catname{hsSets}(X, A(Y))  } 
\label{eq:podkorytov-square} \end{equation}
Here both $\alpha$, $\beta$ map each morphism of simplicial sets to the corresponding class in the homotopy category.
The fact that the above square is cocartesian is equivalent to the surjectivity of the map $\Ker(\alpha)\twoheadrightarrow\Ker(\beta)$.

\begin{equation} \xymatrix{                            & X  \ar[d]^\gamma             &     \\
                            h^{-1}(0)  \ar@{^{(}->}[r] & Y^\infty  \ar[r]^{h_\infty}  & A(Y) } \end{equation}
 
\subsection{Computation of the kernel} 
Recall that for arbitrary set $X$ one can define the space $EX$ as the the simplicial set whose set of $k$-simplices $EX_k$
 is $X^{k+1}$ and whose faces and degeneracies are obtained by omitting and repeating components. 
For a group $G$ we denote by $\pi_G$ the canonical map $EG \to BG$ sending $(g, h) \in EG_1$ to $g^{-1}h \in BG_1$.
 
Now let $N$ be a group acting on $X$. We define two simplicial sets $U$ and $V$ as follows:
\[ U = \bigcup\limits_{n\in N} E(\Gamma_{n.-}) \subseteq E(X\times X),\ \ V = \bigcup\limits_{x,y\in X}E(N(x\to y)) \subseteq EN. \]
Here $\Gamma_{n.-}$ is the graph of the function $(x \mapsto nx)$ and $N(x\to y)$ denotes the subset of elements $n\in N$ satisfying $nx=y$.
With this notation the subset $N(x\to x)$ coincides with the stabilizer subgroup $N_x \leq N$.

\begin{lemma} \label{lm:quillen-a} The simplicial sets $U$ and $V$ are homotopy equivalent. \end{lemma}
\begin{proof} First, we define yet another simplicial set $W$ as follows.
Its $k$-simplices $W_k$ are matrices $\left(\begin{smallmatrix}x_0 & x_1 & \ldots & x_k&\\ n_0 & n_1 & \ldots & n_k \end{smallmatrix}\right)$,
 where $x_i\in X$ are $n_i\in N$ are such that all $n_i$'s act each $x_j$ in the same way, i.\,e. $n_ix_j = n_{i'} x_j$ for $0\leq i,i',j\leq k$. 
 The faces and degeneracies of $W$ are the maps of omission and repetition of columns.
 
 Now there are two simplicial maps $f\colon W\to U$, $g\colon W\to V$ whose action on $0$-simplicies is given by 
  $f\left(\begin{smallmatrix}x_0 \\ n_0\end{smallmatrix}\right) = (x_0, n_0x_0)$, 
  $g\left(\begin{smallmatrix}x_0 \\ n_0\end{smallmatrix}\right) = n_0$. 
 To prove the lemma it suffices to show that $f$ and $g$ are homotopy equivalences. 
 The proof for $f$ and $g$ is similar, let us show, for example, that $g$ is a homotopy equivalence.
 
 In view of Quillen theorem A (cf.\cite[ex.~IV.3.11]{Kbook}) it suffices to show that for each $p$-simplex $d \colon \Delta^p \to V$ the 
  pullback $g/(p, d)$ of $d$ and $g$ is contractible.
 The simplicial set $g/(p, d)$ can be interpreted as the subset of $\Delta^p \times E(X)$ whose set of $k$-simplices consists of pairs
  $(\alpha\colon \underline{k}\to \underline{p}, (x_0, \ldots, x_k)\in X(\alpha, d)^{k+1})$.
 Here $X(\alpha, d)$ is the subset of $X$ consisting of all $x$ for which $d_{\alpha(i)}x = d_{\alpha(j)}x$ for $0\leq i,j\leq k$.
 Notice that the set $X_d := X(id_{\underline{p}}, d)$ is nonempty and is contained in every $X(\alpha, d)$ (it even equals $X(\alpha, d)$ for surjective $\alpha$).
 Now choose a point $\widetilde{x}\in X_d$ and consider the simplicial homotopy \[H\colon \Delta^p \times EX \times \Delta^1 \to \Delta^p\times EX\] 
  between the identity map of $\Delta^p \times EX$ and
 the map $\Delta^p \times c_{\widetilde{x}}$, where $c_{\widetilde{x}}$ is the constant map. 
 More concretely, $H$ sends each triple $(\alpha\colon \underline{k} \to \underline{p}, (x_0, \ldots, x_k), \beta\colon \underline{k}\to\underline{1})$
 to $(\alpha, (x_0, \ldots, x_{i-1}, \widetilde{x}, \ldots, \widetilde{x}))$, where $i$ is the minimal number such that $\beta(i)=1$.
 By the choice of $\widetilde{x}$ the image of $H$ restricted to $g/(p, d)\times \Delta^1$ is contained in $g/(p, d)$, hence $g/(p, d)$ is contractible. 
\end{proof}

Now suppose that $X=H$ is also a group upon which $N$ acts on the left.
It is clear that an element $n \in N$ induces a simplicial map $E(n.-)\colon EH \to EH$.
We consider its graph $\Gamma_{E(n.-)}$ as a subset of $E(H \times H) = EH \times EH$.

\begin{cor} \label{cor:ker-iso}
Consider the following two simplicial sets:
\[ S = \bigcup\limits_{h\in H} BN_h \subseteq BN,\ \ \ T = \pi_N(U) \subseteq B(H \times H).\]
There is an isomorphism $\Ker(\pi_1(S) \to N) \cong \Ker(\pi_1(T) \to H \times H).$
Moreover, the higher homotopy groups of $S$ and $T$ are isomorphic. \end{cor}
\begin{proof}
The required isomorphism can be obtained from the homotopy long exact sequence applied to left arrows of the following two pull-back squares.
\[ \xymatrix{ V  \ar@{^{(}->}[r] \ar[d] \pullbackcorner & \ar[d]^{\pi_N} EN \\
              S \ar@{^{(}->}[r] & BN } \ \ \ 
   \xymatrix{ U  \ar@{^{(}->}[r] \ar[d] \pullbackcorner & \ar[d]^{\pi_{H \times H}} E(H \times H) \\
              T \ar@{^{(}->}[r] & B(H \times H)}  \] \end{proof}

Now let $G$ be a group. Set $N = G \wr S_n$, $H = G^n$ and consider the left action of $N$ on $H$ given by $(g, s) \cdot h = gh^{s^{-1}}$, $g, h\in G^n$, $s\in S_n$.
It is not hard to check that in this case the simplicial subset $T \subset BG^{2n}$ from the above corollary
 coincides with the preimage of $0$ under $h_n \colon BG^{2n} \to \ZZ[BG]$.

It is also easy to compute the map $\pi_1(S) \to N$. Indeed, van Kampen theorem~\cite[Theorem~2.7]{May99} asserts that
$\pi_1(S)$ is isomorphic to the free product of stabilizer subgroups $N_{h} \leq N$ amalgamated over pairwise intersections $N_h \cap N_{h'}$, $h, h\in H$.
For $h \in G^n$ the subgroup $N_h$ consists of elements $(g, s) \in N$ satisfying $gh^{s^{-1}} = h$, i.e. elements of the form $(hh^{-s^{-1}}, s)$.
Thus, $N_h\cong S_n$, $\pi_1(S)$ is isomorphic to the group $S_n(G)$ and the map $\pi_1(S) \to N$ coincides with the map $\mu$ defined in section~\ref{sec:QnG-def}.

\begin{example} \label{ex44}
 We leave it as an exercise to the reader to check that an element $[h_{12}(x), h_{13}(y)] \in \pi_1(S)$ corresponds to the following element of $\pi_1(T)$
  under the isomorphism of \cref{lm:quillen-a}:
 \begin{multline} \label{eq:pathT}
  \gamma_{x,y} = (x[1], x[1]) \circ (x^{-1}[1], x^{-1}[2]) \circ (y[1], y[1]) \circ (y^{-1}[1], y^{-1}[3]) \circ \\ \circ (x[1], x[2]) \circ (x^{-1}[1], x^{-1}[1]) \circ (y[1], y[3]) \circ (y^{-1}[1], y^{-1}[1])).
 \end{multline}  
\end{example}


\begin{proof}[Proof of~\cref{thm:main}]
Factor $h_n$ as a composition of a trivial cofibration followed by a fibration: 
\begin{equation} \label{eq:fibr-repl} \xymatrix{BG^{2n} \ar@{^{(}->}[r] & E_{h_n} \ar@{->>}^(.45){ev_1 \circ \pi_2}[r] & \ZZ[BG]} \end{equation}
For example, we can define $E_{h_n}$ and the homotopy fiber $F_{h_n}$ via the usual path space construction
 (here we use the fact that $BG$ and $\ZZ[BG]$ are fibrant).
\[ \xymatrix{ E_{h_n}  \ar[r]_{\pi_2} \ar[d]_{\pi_1} \pullbackcorner & \ar[d]^{ev_0} \ZZ[BG]^I\\
              BG^{2n} \ar[r]_{h_n} & \ZZ[BG] } \ \ \ 
   \xymatrix{ F_{h_n}  \ar[r] \ar[d] \pullbackcorner & \ar[d]^{ev_1\,\circ\,\pi_2} E_{h_n} \\
              pt \ar[r]_{0} & \ZZ[BG]}  \]
Now write down the starting portion of the long homotopy exact sequence of the fibration $E_{h_n} \twoheadrightarrow \ZZ[BG]$.
If we denote by $K$ the kernel of the map $\nu\colon \pi_1(T) \to G^{2n}$ induced by the embedding $h_n^{-1}(0)=T \subseteq BG^{2n}$ we 
 come to the following commutative diagram.
\[ \xymatrix{1 \ar[r] & K       \ar[d]_{\psi} \ar[r] & \pi_1(T) \ar[d]_{\phi} \ar[r]_{\nu}     & G^{2n} \ar[rd] \ar[d]_{\cong} &                      & \\
             1 \ar[r] & \HH_2(G, \ZZ) \ar[r] & \pi_1(F_{h_n})           \ar[r]  & \pi_1(E_{h_n}) \ar[r]  & \HH_1(G, \ZZ) \ar[r] & 1}\]
We already know by~\cref{cor:ker-iso} and {\bf ???} that $K$ is isomorphic to $\HH_2(G, \ZZ)$ provided $n\geq 3$.
Notice that this isomorphism is natural in $G$.

Let us show that $\psi$ is an isomorphism. Assume for a momemnt that $G$ is an abelian group.
In this case a generator $x \wedge y$ of $\HH_2(G, \ZZ)$ in Miller's presentation corresponds to the class of 2-cycle $c = (x, y) - (y, x)$ (cf.~\cite[(14), p.~582]{Mi52}), which,
  in turn, corresponds to the following normalized 2-cycle:
\begin{equation} \label{eq:normalized} c' = c - s_0d_0c - s_1d_1c + s_1d_0 = (x, y) - (y, x) - (x, 0) +(y, 0) + (0, x) - (0, y). \end{equation}
 
Since $F_{h_n}$ and $\ZZ[BG]$ are fibrant, any element of $\pi_1(F_{h_n}, 0)$ can be represented with 
 some 1-simplex $(\gamma, s) \in G^{2n} \times \ZZ[BG]_2$ satisfying $d_2(s) = h_n(\gamma)$, $d_0(s) = d_1(s)=0$. 
It remains to find in $F_{h_n}$ the 1-simplex homotopic to the path $\phi(\gamma_{x,y})$ (cf.~\cref{ex44}).

We use the following inductive procedure. Let $\gamma_0$ be an initial segment of a path $\gamma$ in $T$ for which we have already found such simplex
 $(g^0, s^0)$ in $F_{h_n}$ and let $g \in T_1$ be the next chain link. 
Set $s_0 = \sum (a_j, b_j) \in\ZZ[BG]_2$, $t = h_n (g^0, g) = \sum_{i=1}^{2n}(-1)^i(g^0_i, g_i)$
and compute the filler for the $3$-horn $(0,\ , s_0, t)$. Denote the $1$-st face of this filler by $s_1$.
It is clear that $(g^0g, s_1)$ is the image of $\gamma^0 \circ g$ via $\phi$.
The concrete formula for $s_1$ can be chosen e.\,g. as follows:
\[s_1 = \sum_{i=1}^{2n}(g^0_i + g_i, -g_i) - \sum_j (a_j + b_j, -b_j).\]

Applying the above recipe to the path $\gamma_{x, y}$ yields an expression equal to~\eqref{eq:normalized}.
 This shows that $\psi$ is the identity map for an abelian group $G$.
Since $\psi$ is natural in $G$, by~\cref{lm:endotr} below we get that $\psi$ is an isomorphism for arbitrary $G$,
 therefore $\phi$ is also an isomorphism, as claimed.
\end{proof}

\begin{lemma} \label{lm:endotr} The only natural endotransformations of the second homology functor $\HH_2(-, \ZZ)\colon \catname{Groups}\to \catname{Ab}$ 
 are morphisms of multiplication by $n \in \ZZ$.
\end{lemma}
\begin{proof}
 Denote by $\eta$ an endotransformation $\HH_2(-, \ZZ) \to \HH_2(-, \ZZ)$.
 When restricted to the subcategory of free finitely-generated abelian groups $\catname{Add}(\ZZ) \subseteq \catname{Ab}$ the second homology functor
 coincides with the second exterior power functor $A \mapsto \wedge^2A$. 
 
 Recall from~\cite[Theorem~6.13.12]{Ba96} that the category of quadratic functors is equivalent to the category of quadratic $\ZZ$-modules (see Definition~6.13.5 ibid.)
 The functor $A \mapsto \wedge^2A$ is clearly quadratic and corresponds to the quadratic $\ZZ$-module $0 \to \ZZ \to 0$ under this equivalence.
 Thus, we get that $\eta$ restricted to $\catname{Add}(\ZZ)$ coincides with the the morphism of multiplication by $n\in \ZZ$.
 
 Consider the group $\Gamma_k = \langle x_1, y_1, \ldots x_k, y_k \mid [x_1, y_1]\cdot \ldots \cdot [x_k, y_k] \rangle$ (the fundamental group of a sphere with $k$ handles).
 It is clear that the abelianization map $\Gamma_k \to \ZZ^{2k}$ induces an injective map $\HH_2(\Gamma_k, \ZZ) \cong \ZZ \to \wedge^2\ZZ^{2k}$.  
 Consider the following diagrams.
  \[ \xymatrix{ \ZZ \ar@{^{(}->}[r] \ar[d]_{\eta_{\Gamma_k}} & \ar[d]^{n \cdot} \wedge^2\ZZ^{2k} \\
                \ZZ \ar@{^{(}->}[r]                          & \wedge^2\ZZ^{2k} } \ \ \ 
     \xymatrix{   \ZZ  \ar[r]^(.35){\chi} \ar[d]_{\eta_{\Gamma_k}} & \ar[d]^{\eta_G} \HH_2(G, \ZZ) \\
                  \ZZ  \ar[r]^(.35){\chi}                          & \HH_2(G, \ZZ)}  \]
 From the left diagram it follows that $\eta_{\Gamma_k}$ is also the morphism of multiplication by $n$.
 For every element $x\in \HH_2(G, \ZZ)$ there exist an integer $k$ and a map $\chi\colon \Gamma_k\to G$ sending the generator of $\HH_2(\Gamma_k, \ZZ)$ to $x$.
 From the right square we conclude that $\eta_G(x) = nx$, as claimed.

 
\end{proof}



\begin{comment}                           
\section{Algebraic computatation of $Q_n(G)$}


\subsection{A presentation for $S_n(G)$ and $HS_n(G)$} \label{sec:QHQ-pres}

It it easy to check that $\mu(h_{ij}(a)) = d_{ij}(g)$.
Thus, the groups defined in section~\ref{sec:QnG-def} fit into the following commutative diagram.
\begin{equation} \xymatrix{1 \ar[r] & \mathrm{Ker}(\mu) \ar[r] \ar@{=}[d] & HQ_n(G) \ar[r] \ar@{^{(}->}[d] &  D_n(G)   \ar[r] \ar@{^{(}->}[d] & 1      &   \\
                           1 \ar[r] & \mathrm{Ker}(\mu) \ar[r]            & Q_n(G)  \ar[r]                 & G \wr S_n \ar[r]                 & G_{ab} \ar[r] & 1} 
\label{eq:comm-diagram} \end{equation}




\section{Comparison with $\HH_2(G, \mathbb{Z})$.}

We are now going to compare $C_n(G)$ with the second homology group $\HH_2(G, \mathbb{Z})$.
More precisely, we construct a surjective map $\theta\colon \HH_2(G, \mathbb{Z}) \to C_n(G)$ for $n\geq 3$.
This construction is heavily inspired by \cite[\S~4.3]{Lo76}, cf. also with~\cite[\S~4F]{KKM}.

\begin{lemma}\label{lm:hprop} The elements $h_{ij}(a)$ satisfy the following properties.
\begin{lemlist}
  \item \label{item-h-mu}    One has $\mu(h_{ij}(a)) = a[i] \cdot a^{-1}[j] \in G^n$.
  \item \label{item-h-inv}   One has $h_{ij}(g)= h_{ji}(g^{-1}) = h_{ji}(g)^{-1}$.  
  \item \label{item-h-conj}  If $g, g' \in G^n$ are such that $g_i = g'_i$ and $g_j=g'_j$ then $h_{ij}(a)^g = h_{ij}(a)^{g'}$.
  \item \label{item-h-comm}  If $q_1, q_2 \in \mu^{-1}(G^n)\leq Q_n(G)$ and $1 \leq i\neq j\leq n$ are such that $\mu(q_1)_i=\mu(q_2)_i$ and $\mu(q_1)_j=\mu(q_2)_j$, then for $a\in G$ one has
        $[q_1, h_{ij}(a)] = [q_2, h_{ij}(a)]$.
  \item \label{item-h-comm2} For $a,b,c \in G$ and arbitrary distinct indices $i,j,k$ one has
        \[[h_{ij}(ab),\ h_{ik}(c)] = [h_{ij}(a) h_{ij}(b),\ h_{ik}(c)].\]
\end{lemlist} \end{lemma}
\begin{proof}
The first two assertions of the lemma are straightforward.
The third assertion follows from relations~\eqref{eq:action} and~\eqref{eq:main_rel2}.
Indeed for $g\in G^n$ we have $h_{ij}(a) ^{g} = (ij)_{a[j] \cdot g} (ij)_{g} = (ij)_{g_i[i] (ag_j)[j]} \cdot (ij)_{g_i[i] g_j[j]},$
and it is clear that the last expression depends only on the $i$-th and $j$-th components of $g$.

Combining the third assertion with Peiffer identity yields the fourth assertion:
\[ [q_1, h_{ij}(a)] = h_{ij}(a)^{q_1^{-1}} h_{ij}(a)^{-1} = h_{ij}(a)^{\mu(q_1)^{-1}} h_{ij}(a)^{-1} =  h_{ij}(a)^{\mu(q_2)^{-1}} h_{ij}(a)^{-1} = [q_2, h_{ij}(a)]. \]

It remains to prove the last assertion. Direct computation shows that
\[\mu(h_{ij}(ab)) = (ab)[i] (ab)^{-1}[j],\ \mu(h_{ij}(a) h_{ij}(b)) = (ab)[i] (ba)^{-1}[j].\]
Since the $i$-th and $k$-th components of these vectors are equal we get the required statement as a corollary of the fourth assertion.
\end{proof}

Now one can define the symbol $\{a, b\}_i$ as the commutator $[h_{ij}(a), h_{ik}(b)]$, where
$i$, $j$ and $k$ are distinct indices and $a, b$ are elements of $G$.
\begin{lemma}\label{lm:symbprop} The symbols $\{a,b\}_i$ possess the following properties.
\begin{lemlist}
 \item \label{item-symb-mu}    One has $\mu(\{a, b\}_i) = [a,\ b][i].$
 \item \label{item-symb-corr}  The symbol $\{a, b\}_i$ is fixed by any permutation $s\in S_n$ which fixes $i$, in particular $\{a, b\}_i$ does not depend on the choice of indices $j,k$.
 \item \label{item-symb-def1}  For arbitrary $j\neq i$ one has $\{a, b\}_i = (ij)_{(ab)[j]} (ij)_{a[j]} (ij)_1 (ij)_{b[j]}.$
 \item \label{item-symb-asymm} One has $\{a, b\}_i^{-1} = \{b, a\}_i$, moreover $\{a, a\}_i=1$.
 \item \label{item-symb-def2}  One has $\{a, b\}_i = h_{ij}(ab) \cdot h_{ij}(a^{-1}) h_{ij}(b^{-1}).$
\end{lemlist}
\end{lemma}
\begin{proof}
The second assertion follows from~\eqref{eq:action} and~\eqref{eq:main_rel2}, indeed:
 \[s_1^{\{ a, b\}_i} = s_1^{[a, b][i]} = s_{[a,b][i]} = s_1.\]
The third assertion can be obtained by repeated application of~\eqref{eq:Peiffer-gen} and~\eqref{eq:main_rel2}:
 \begin{multline}\label{eq:h-conj}
 h_{ij}(b)^{h_{ik}(a)^{-1}} = (ik)_{a[k]} \cdot \left( (ik)_1 \cdot (ij)_{b[j]} (ij)_1 \cdot (ik)_1 \right) \cdot (ik)_{a[k]} = \\
= \left((ik)_{a[k]} \cdot (kj)_{b[j]} (kj)_1 \cdot (ik)_{a[k]} \right) = (ij)_{b[j](a^{-1})[i] a[k]} (ij)_{(a^{-1})[i] a[k]} =
 (ij)_{(ab)[j]} (ij)_{a[j]}.
\end{multline}

For a sequence $a_1,\ldots, a_p$ of elements of $G$ we denote by $[[a_1,\ldots, a_p]]_{ij}$ the product $(ij)_{a_1[j]}\ldots (ij)_{a_p[j]}$.
With this notation, we can rewrite the third assertion of the lemma as
\[\{a, b\}_i = [[ab, a, 1, b]]_{ij}.\]
It is clear that $[[a, a]]_{ij}=1$. From~\eqref{eq:Peiffer-gen} we also get that $[[a,b,a]]_{ij} = [[ab^{-1}a]]_{ij}$. 
Now using these two identities we can demonstrate the last two assertions of the lemma.
\begin{equation} \nonumber \{a, a\}_i = [[a^2, a, 1, a]]_{ij} =[[a^2, a^2]]_{ij} = 1; \end{equation} 
\begin{multline} \nonumber \{a, b\}_i \cdot \{b, a\}_i = [[ab, a, 1, b, ba, b, 1, a]]_{ij} = [[ab, a, b^{-1}, (ba)^{-1}, b^{-1}, a]]_{ij} = \\ =[[ab, a, ab^{-1}, a]]_{ij} = [[ab, ab]]_{ij} = 1; \end{multline}
\[h_{ij}(ab) \cdot h_{ij}(a^{-1}) h_{ij}(b^{-1}) = [[ ab, 1, a^{-1}, 1, b^{-1}, 1 ]]_{ij} = [[ ab, a, 1, b ]]_{ij} = \{a, b\}_i. \qedhere\]
\end{proof}


Now choose arbitrary index $1 \leq i\leq n$ and consider the map $\theta_i\colon\Theta(G)\to Q_n(G)$ defined by $\theta_i((a,b)) = \{a, b\}_i$.
\begin{prop} \label{prop:miller-rels} The image of $B(G)$ under $\theta_i$ is trivial. \end{prop}
\begin{proof}
 By~\cref{item-symb-asymm} the relations~\eqref{R1}--\eqref{R2} are preserved by $\theta_i$.
 For the remaining two relations the proof is similar to~\cite[Prop.~4.9]{KKM}.
 By~\cref{item-h-comm2} we get that
 \[ \{ca, b\}_i = [h_{ij}(c) h_{ij}(a),\ h_{ik}(b)] = {}^{h_{ij}(c)}\![ h_{ij}(a),\ h_{ik}(b)] \cdot [h_{ij}(c), h_{ik}(b)]. \]
 
 Now set 
 \begin{align} 
  A = h_{ij}(cac^{-1}), & & & A' = h_{ij}(c) h_{ij}(a) h_{ij}(c)^{-1}, \nonumber \\ 
  B = h_{ij}(c)^{-1} h_{ik}(cbc^{-1})h_{ij}(c), & & & B'=h_{ik}(b) \nonumber.
 \end{align}
 It is clear that 
 \begin{align} \nonumber
  \mu(A)_i = cac^{-1} = \mu(A')_i, & & & \mu(A)_k = 1 = \mu(A')_k,\\ 
  \mu(B)_i=b=\mu(B')_i, & & & \mu(B)_j = 1 = \mu(B')_j,
 \end{align}
 hence by~\cref{item-h-comm} we get that
\begin{multline}\label{eq:A1}
\{cac^{-1}, cbc^{-1} \}_i = [A, h_{ik}(cbc^{-1})] = [A',\ h_{ik}(cbc^{-1})] = {}^{h_{ij}(c)}[h_{ij}(a),\ h_{ik}(cbc^{-1})^{h_{ij}(c)}] = \\
= {}^{h_{ij}(c)}\![h_{ij}(a),\ B] = {}^{h_{ij}(c)}\![h_{ij}(a),\ B'] = {}^{h_{ij}(c)}\![h_{ij}(a), h_{ik}(b)].
\end{multline}
hence~\eqref{R3} is preserved by~$\theta_i$. Finally, to show that $\theta_i$ preserves~\eqref{R4} it remains to use~\eqref{eq:A1},
\cref{item-h-comm},\cref{item-symb-mu}~and~\ref{item-symb-corr}:
\begin{multline}\nonumber \{cac^{-1},cbc^{-1}\}_i \cdot \{b, a\}_i = {}^{h_{ij}(c)}\![h_{ij}(a), h_{ik}(b)] \cdot [h_{ik}(b),\ h_{ij}(a)] = \\
 = [h_{ij}(c),\ [h_{ij}(a),\ h_{ik}(b)]] = [h_{ij}(c),\ h_{ik}([a,\ b])] = \{c, [a,\ b]\}_i. \qedhere \end{multline}
\end{proof}

\begin{cor}
 There is a map $\theta\colon \HH_2(G, \mathbb{Z})\to C_n(G)$ induced by $\theta_i$ which does not depend on the choice of $i$.
\end{cor}
\begin{proof}
  By a theorem of Miller (see~\cite{Mi52}) the group $\HH_2(G, \mathbb{Z})$ can be presented as the quotient $Z(G)/B(G)$.
  We have just shown that there is a well-defined map $\theta_i\colon \Theta(G)/B(G) \to Q_n(G)$. 
  By~\cref{item-symb-mu} the image of $Z(G)$ lies in $C_n(G)$.
  Since $C_n(G)$ is central in $Q_n(G)$ we see that the resulting map $Z(G)/B(G) \to C_n(G)$ does not depend on $i$.
\end{proof}

Our next goal is to show that the map $\theta$ is surjective. 
We start with the following technical result (cf. with the relations P1', P4' from the proof of~\cite[Lemma~4.3.5]{Lo76}).
\begin{lemma}\label{h-identities}
 The elements $h_{ij}(g)$ satisfy the following relations.
 \begin{enumerate}
  \item For distinct indices $i,j,k$ one has $h_{jk}(g) = h_{ij}(g^{-1}) h_{ik}(g).$
  \item The following identities hold:
  \begin{equation} \nonumber \begin{aligned}[t]
    h_{1i}(v) \cdot h_{1k}(u) & = h_{1k}(u)  \cdot h_{1i}(u^{-1}v) h_{1i}(u),            & i\neq 1, k; \\
    h_{1k}(v) \cdot h_{1k}(u) & = h_{1k}(uv) \cdot h_{12}((uv)^{-1}) h_{12}(v) h_{12}(u),& k > 2.
  \end{aligned} \end{equation}
 \end{enumerate} 
\end{lemma}
\begin{proof}
To prove the first assertion compute the value of the commutator $[h_{ij}(g^{-1}), (jk)]$ in two different ways:
\begin{multline} \nonumber
 h_{jk}(g) = (jk)_1^{g^{-1}[j]} \cdot (jk)_1 = (jk)_1^{h_{ij}(g)}(jk)_1 = \\ 
 = [h_{ij}(g^{-1}), (jk)_1] = h_{ij}(g^{-1}) \cdot h_{ij}(g)^{(jk)} = h_{ij}(g^{-1}) h_{ik}(g).
\end{multline}
The first formula in the second assertion of the lemma follows from~\eqref{eq:h-conj}:
 \[ h_{1i}(v)^{h_{1k}(u)} = (1i)_{(u^{-1}v)[i]} (1i)_{u^{-1}[i]} = [[u^{-1}v, u^{-1}]]_{1i} = [[ u^{-1}v, 1, u, 1 ]]_{1i} = h_{1i}(u^{-1}v) h_{1i}(u). \]
The other formula follows from~\cref{item-symb-corr},~\ref{item-symb-def2} and~\cref{item-h-inv}.
\end{proof}



The proof of the next proposition is similar to~\cite[Lemma~4.3.5]{Lo76}.
\begin{prop} For $n\geq 3$ the group $C_n(G)$ is generated by symbols $\{a, b\}_1$, $a, b\in G$. In particular, the map $\theta\colon \HH_2(G, \mathbb{Z})\to C_n(G)$ is surjective. \end{prop}
\begin{proof}
Combining the first assertion of~\cref{h-identities} with the previous lemma we get that any element $q$ of $C_n(G)$ can be
written as a product of elements $h_{1i}(a)$ (where $a\in G$ and $1< i\leq n$).

Denote by $k$ the largest index $i$ occuring in this expression for $q$. 
The identities from the second assertion of~\cref{h-identities} allow us to ``move'' all the factors $h_{1k}(g)$ to the left-hand side of the expression
until possibly one such factor is left, i.\,e. until $q$ has the form $q=h_{1k}(a) \cdot \left(h_{1i_1}(a_1) \cdot \ldots \cdot h_{1i_N}(a_N)\right)$ where all indices $i_1,\ldots i_N$ are less than $k$.
Since $1 = \mu(q)_k = \mu(h_{1k}(a))_k = a^{-1}$ the element $h_{1k}(a)$ is trivial and the new expression for $q$ only contains $h_{1i}(g)$ with $i$ less than $k$.

We can repeat the above argument several times until $k$ becomes equal to $2$, i.\,e. until $q$ is written as $\prod_{i=1}^N h_{12}(a_i)$.
From~\cref{item-symb-asymm}~and~\ref{item-symb-def2} it follows that 
\[ h_{12}(a) h_{12}(b) = \{a, b\}_1 \cdot h_{12}(ba).\]
Thus, we can rewrite $q$ as follows:
\begin{multline} \nonumber
q = \{ a_1, a_2\}_1 \cdot h_{12}(a_2a_1) \cdot \prod_{i=3}^N h_{12}(a_i) = \ldots \\ 
\ldots = \{a_1, a_2\}_1 \cdot \{a_2a_1, a_3 \}_1 \cdot \ldots \cdot \{a_{N-1}\cdot\ldots\cdot a_1, a_N\}_1 \cdot h_{12}(a_N\cdot\ldots\cdot a_1). 
\end{multline}
Since $1 = \mu(q)_2 = \mu(h_{12}(a_N\cdot\ldots\cdot a_1))_2 = (a_N\cdot\ldots\cdot a_1)^{-1}$, we obtain the assertion of the proposition.
\end{comment}


\printbibliography

\end{document}
